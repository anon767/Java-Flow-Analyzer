# Rustparse

Rustparse analyzes Semantic Flows of Java Programs.

## How Does it Work?

As the name suggests, Rustparse is written in Rust. It uses the tree-sitter C++ binding to 
obtain the AST per java files. The Call and Control Flow edges are calculated on statement-level
for easy querying.
The transitive closure of the Flow Graph is calculated using a logical programming Language written in Rust called *Crepe* .

## How To use?
First build the tool:
```
cargo build
```

Place a TOML Configuration file inside your Java Project.

E.g.

```
project = "src/"

[[nodes]]
name = "dynamicDispatch"
code = ".*Class.forName.*"

[[nodes]]
name = "someSource"
identifier = "method_declaration"
code = ".*Response.*"

[[flows]]
from = "someSource"
to = "dynamicDispatch"
```

And call it using:
```
rustparse --path=<path to config>
```

The output may look like following:
```
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "try{\n\t\t  String sproc = String.format(\"{call %s(%s)}\", storedProc, sprocParamCount);\n\t\t  //String insert = \"INSERT INTO [StrongMail].[dbo].[SUCCESS_LOG] ( [Datestamp], [Email], [OUTBOUNDIP], [OUTBOUNDHOST], [MXIP], [MXHOST], [TemplateId], [Uuid] ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ? )\";\n\t\t  Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n\t\t  if(dbsystem.equals(\"azure\")){\n\t\t\t con = DriverManager.getConnection(azureConnection);\n\t\t  }\n\t\t  else{\n\t\t     con = DriverManager.getConnection(jdbcHandle, dbusername, dbpassword);\n\t\t  }\n\t\t  \n\t\t  callableStatement = con.prepareCall(sproc);\n\t\t  //pstmt = con.prepareStatement(insert);\n\t\t  \n\t\t  for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(userfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(User.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }\n\n\t\t    callableStatement.executeUpdate();\n\t\t      \n\t\t      /*\n\t\t      pstmt.setTimestamp(1, es.timestamp);\n\t\t      pstmt.setString(2, es.toAddress);\n\t\t      pstmt.setString(3, es.outboundIP);\n\t\t      pstmt.setString(4, es.outboundHost);\n\t\t      pstmt.setString(5, es.remoteIP);\n\t\t      pstmt.setString(6, es.remoteHost);\n\t\t      pstmt.setInt(7, Integer.valueOf(es.templateId));\n\t\t      pstmt.setString(8, es.uuid);\n\t\t      int insertResult = pstmt.executeUpdate();\n\t\t      */\n\t\t      //System.out.println(\"Remote Success \" + String.valueOf(insertResult));\n\t\t}\n\t\tcatch(SQLException sqle){\n\t\t\tsqle.printStackTrace();\n\t\t\tlog.error(\"SQL EXCEPTION: \" + sqle.getMessage());\n\t\t}\n\t\tcatch(Exception e){\n\t\t\te.printStackTrace();\n\t\t\tlog.error(\"EXCEPTION: \" + e.getMessage());\n\t\t}\n                finally{\n                     if (callableStatement != null){\n                       try {\n\t\t\t\t\t\tcallableStatement.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n                     if (con != null){\n                       try {\n\t\t\t\t\t\tcon.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n\n                  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(userfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(User.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "if (Arrays.asList(userfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(User.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(userfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Method method = Class.forName(User.class.getName()).getDeclaredMethod(methodString);"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "try{\n\t\t  String sproc = String.format(\"{call %s(%s)}\", storedProc, sprocParamCount);\n\t\t  //String insert = \"INSERT INTO [StrongMail].[dbo].[SUCCESS_LOG] ( [Datestamp], [Email], [OUTBOUNDIP], [OUTBOUNDHOST], [MXIP], [MXHOST], [TemplateId], [Uuid] ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ? )\";\n\t\t  Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n\t\t  con = DriverManager.getConnection(jdbcHandle, dbusername, dbpassword);\n\t\t  //con = DriverManager.getConnection(azureConnection);\n\t\t  callableStatement = con.prepareCall(sproc);\n\t\t  //pstmt = con.prepareStatement(insert);\n\t\t  \n\t\t  for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(thedailyjackpotuserfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(TheDailyJackpotUser.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }\n\n\t\t    callableStatement.executeUpdate();\n\t\t      \n\t\t      /*\n\t\t      pstmt.setTimestamp(1, es.timestamp);\n\t\t      pstmt.setString(2, es.toAddress);\n\t\t      pstmt.setString(3, es.outboundIP);\n\t\t      pstmt.setString(4, es.outboundHost);\n\t\t      pstmt.setString(5, es.remoteIP);\n\t\t      pstmt.setString(6, es.remoteHost);\n\t\t      pstmt.setInt(7, Integer.valueOf(es.templateId));\n\t\t      pstmt.setString(8, es.uuid);\n\t\t      int insertResult = pstmt.executeUpdate();\n\t\t      */\n\t\t      //System.out.println(\"Remote Success \" + String.valueOf(insertResult));\n\t\t}\n\t\tcatch(SQLException sqle){\n\t\t\tsqle.printStackTrace();\n\t\t\tlog.error(\"SQL EXCEPTION: \" + sqle.getMessage());\n\t\t}\n\t\tcatch(Exception e){\n\t\t\te.printStackTrace();\n\t\t\tlog.error(\"EXCEPTION: \" + e.getMessage());\n\t\t}\n                finally{\n                     if (callableStatement != null){\n                       try {\n\t\t\t\t\t\tcallableStatement.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n                     if (con != null){\n                       try {\n\t\t\t\t\t\tcon.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n\n                  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(thedailyjackpotuserfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(TheDailyJackpotUser.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "if (Arrays.asList(thedailyjackpotuserfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(TheDailyJackpotUser.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(user);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(user);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(user);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(thedailyjackpotuserfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(user);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Method method = Class.forName(TheDailyJackpotUser.class.getName()).getDeclaredMethod(methodString);"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "try{\n\t\t  String sproc = String.format(\"{call %s(%s)}\", storedProc, sprocParamCount);\n\t\t  //String insert = \"INSERT INTO [StrongMail].[dbo].[SUCCESS_LOG] ( [Datestamp], [Email], [OUTBOUNDIP], [OUTBOUNDHOST], [MXIP], [MXHOST], [TemplateId], [Uuid] ) VALUES ( ?, ?, ?, ?, ?, ?, ?, ? )\";\n\t\t  Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");\n\t\t  con = DriverManager.getConnection(jdbcHandle, dbusername, dbpassword);\n\t\t  //con = DriverManager.getConnection(azureConnection);\n\t\t  callableStatement = con.prepareCall(sproc);\n\t\t  //pstmt = con.prepareStatement(insert);\n\t\t  \n\t\t  for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(surveyfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(HealthSurvey.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(survey);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(survey);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(survey);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(survey);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }\n\n\t\t    callableStatement.executeUpdate();\n\t\t      \n\t\t      /*\n\t\t      pstmt.setTimestamp(1, es.timestamp);\n\t\t      pstmt.setString(2, es.toAddress);\n\t\t      pstmt.setString(3, es.outboundIP);\n\t\t      pstmt.setString(4, es.outboundHost);\n\t\t      pstmt.setString(5, es.remoteIP);\n\t\t      pstmt.setString(6, es.remoteHost);\n\t\t      pstmt.setInt(7, Integer.valueOf(es.templateId));\n\t\t      pstmt.setString(8, es.uuid);\n\t\t      int insertResult = pstmt.executeUpdate();\n\t\t      */\n\t\t      //System.out.println(\"Remote Success \" + String.valueOf(insertResult));\n\t\t}\n\t\tcatch(SQLException sqle){\n\t\t\tsqle.printStackTrace();\n\t\t\tlog.error(\"SQL EXCEPTION: \" + sqle.getMessage());\n\t\t}\n\t\tcatch(Exception e){\n\t\t\te.printStackTrace();\n\t\t\tlog.error(\"EXCEPTION: \" + e.getMessage());\n\t\t}\n                finally{\n                     if (callableStatement != null){\n                       try {\n\t\t\t\t\t\tcallableStatement.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n                     if (con != null){\n                       try {\n\t\t\t\t\t\tcon.close();\n\t\t\t\t\t    } catch (SQLException e) {}\n                      }\n\n                  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Class.forName(\"com.microsoft.sqlserver.jdbc.SQLServerDriver\");"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "for (Field field : allFields) {\n\t\t    \t\n\t\t\t String fieldName = field.getName();\n\t\t\t if (Arrays.asList(surveyfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(HealthSurvey.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(survey);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(survey);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(survey);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(survey);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }  \n\t\t    }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "if (Arrays.asList(surveyfields).contains(fieldName)){\n\t\t\t  \n\t\t\t    String methodString = String.format(\"get%s\", fieldName.replaceFirst(String.valueOf(fieldName.charAt(0)), String.valueOf(Character.toUpperCase(fieldName.charAt(0)))) );\n\t\t\t    Method method = Class.forName(HealthSurvey.class.getName()).getDeclaredMethod(methodString);\n\t\t\t  \n\t\t        if (field.getType() == String.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tString userValue = (String) method.invoke(survey);\n\t\t        \tcallableStatement.setString(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Integer.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tInteger userValue = (Integer) method.invoke(survey);\n\t\t        \tcallableStatement.setInt(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Long.class) {\n\t\t        \t\n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tLong userValue = (Long) method.invoke(survey);\n\t\t        \tcallableStatement.setLong(param, userValue);\n\t\t        \t\n\t\t        }\n\t\t        else if (field.getType() == Timestamp.class) {\n\t\t           \n\t\t        \tint param = Arrays.asList(surveyfields).indexOf(field.getName()) + 1;\n\t\t        \tTimestamp userValue = (Timestamp) method.invoke(survey);\n\t\t        \tcallableStatement.setTimestamp(param, userValue);\n\t\t        }\n\t\t        \n\t\t\t  }"
____________________________________
"someSource" reaches "dynamicDispatch"
Source "@POST\n    \t@Path(\"/addsurvey/json\")\n        @Consumes(MediaType.APPLICATION_JSON)\n        @Produces(MediaType.APPLICATION_JSON)\n        public Response addSurvey(HealthSurvey survey, @Context UriInfo uriInfo,  @Context HttpServletRequest req) {\n\n        \tArrayList<String> response = new ArrayList<String>();\n        \tMultivaluedMap<String, String> paramsMap = null;\n        \t\n        \ttry{\n        \t\tresponse.add(\"OK\");\n                paramsMap = uriInfo.getQueryParameters();   \n                \n                EmailDAO.loadData(\"dbo.HealthSurvey_Add\", survey);\n                \n        \t   }\n        \t  catch(Exception ex){\n        \t\t  log.error(ex.getMessage());\n        \t\t  return Response.serverError().build();\n        \t  }\n              \n        \t        \t  \n        \tlogRequest(String.valueOf(survey.getSessionid()), req.getRemoteHost(), req.getRemoteAddr(), \"/addsurvey/json\");\n        \t\n        \treturn Response.status(200).entity(response).build();\n        \n        }"
Target "Method method = Class.forName(HealthSurvey.class.getName()).getDeclaredMethod(methodString);"
____________________________________
```
